<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Maps | 高级统计绘图</title>
  <meta name="description" content="Chapter 4 Maps | 高级统计绘图" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Maps | 高级统计绘图" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Maps | 高级统计绘图" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="other-advanced-plots.html"/>
<link rel="next" href="plotly.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>📊 高级统计绘图</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ggplot2.html"><a href="ggplot2.html#散点图"><i class="fa fa-check"></i><b>2.1</b> 散点图</a></li>
<li class="chapter" data-level="2.2" data-path="ggplot2.html"><a href="ggplot2.html#条形图和箱线图"><i class="fa fa-check"></i><b>2.2</b> 条形图和箱线图</a></li>
<li class="chapter" data-level="2.3" data-path="ggplot2.html"><a href="ggplot2.html#直方图和密度曲线图"><i class="fa fa-check"></i><b>2.3</b> 直方图和密度曲线图</a></li>
<li class="chapter" data-level="2.4" data-path="ggplot2.html"><a href="ggplot2.html#时间序列图"><i class="fa fa-check"></i><b>2.4</b> 时间序列图</a></li>
<li class="chapter" data-level="2.5" data-path="ggplot2.html"><a href="ggplot2.html#图形标注"><i class="fa fa-check"></i><b>2.5</b> 图形标注</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="other-advanced-plots.html"><a href="other-advanced-plots.html"><i class="fa fa-check"></i><b>3</b> Other Advanced Plots</a>
<ul>
<li class="chapter" data-level="3.1" data-path="other-advanced-plots.html"><a href="other-advanced-plots.html#三维图形"><i class="fa fa-check"></i><b>3.1</b> 三维图形</a></li>
<li class="chapter" data-level="3.2" data-path="other-advanced-plots.html"><a href="other-advanced-plots.html#词云"><i class="fa fa-check"></i><b>3.2</b> 词云</a></li>
<li class="chapter" data-level="3.3" data-path="other-advanced-plots.html"><a href="other-advanced-plots.html#散点图矩阵与关系矩阵图"><i class="fa fa-check"></i><b>3.3</b> 散点图矩阵与关系矩阵图</a></li>
<li class="chapter" data-level="3.4" data-path="other-advanced-plots.html"><a href="other-advanced-plots.html#马赛克图"><i class="fa fa-check"></i><b>3.4</b> 马赛克图</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>4</b> Maps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="maps.html"><a href="maps.html#maps包"><i class="fa fa-check"></i><b>4.1</b> maps包</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="maps.html"><a href="maps.html#世界地图"><i class="fa fa-check"></i><b>4.1.1</b> 世界地图</a></li>
<li class="chapter" data-level="4.1.2" data-path="maps.html"><a href="maps.html#美国地图"><i class="fa fa-check"></i><b>4.1.2</b> 美国地图</a></li>
<li class="chapter" data-level="4.1.3" data-path="maps.html"><a href="maps.html#中国地图"><i class="fa fa-check"></i><b>4.1.3</b> 中国地图</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="maps.html"><a href="maps.html#remap包"><i class="fa fa-check"></i><b>4.2</b> REmap包</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="maps.html"><a href="maps.html#获取经纬度信息"><i class="fa fa-check"></i><b>4.2.1</b> 获取经纬度信息</a></li>
<li class="chapter" data-level="4.2.2" data-path="maps.html"><a href="maps.html#获取各省市的市区级行政单位名称"><i class="fa fa-check"></i><b>4.2.2</b> 获取各省（市）的市（区）级行政单位名称</a></li>
<li class="chapter" data-level="4.2.3" data-path="maps.html"><a href="maps.html#地图可视化"><i class="fa fa-check"></i><b>4.2.3</b> 地图可视化</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Plotly</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#plotly简介"><i class="fa fa-check"></i><b>5.1</b> Plotly简介</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#plotly工作流"><i class="fa fa-check"></i><b>5.2</b> Plotly工作流</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#构建plotly对象"><i class="fa fa-check"></i><b>5.2.1</b> 构建plotly对象</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#添加trace"><i class="fa fa-check"></i><b>5.2.2</b> 添加trace</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#获取源数据"><i class="fa fa-check"></i><b>5.2.3</b> 获取源数据</a></li>
<li class="chapter" data-level="5.2.4" data-path="plotly.html"><a href="plotly.html#发布可视化作品"><i class="fa fa-check"></i><b>5.2.4</b> 发布可视化作品</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#plotly基础"><i class="fa fa-check"></i><b>5.3</b> Plotly基础</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.1</b> markers</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#lines"><i class="fa fa-check"></i><b>5.3.2</b> Lines</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#bars-histograms"><i class="fa fa-check"></i><b>5.3.3</b> Bars &amp; histograms</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#boxplots"><i class="fa fa-check"></i><b>5.3.4</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#plotly进阶"><i class="fa fa-check"></i><b>5.4</b> Plotly进阶</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotly.html"><a href="plotly.html#ggplotly"><i class="fa fa-check"></i><b>5.4.1</b> ggplotly</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotly.html"><a href="plotly.html#layout"><i class="fa fa-check"></i><b>5.4.2</b> layout</a></li>
<li class="chapter" data-level="5.4.3" data-path="plotly.html"><a href="plotly.html#javascript"><i class="fa fa-check"></i><b>5.4.3</b> Javascript</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization-project.html"><a href="visualization-project.html"><i class="fa fa-check"></i><b>6</b> Visualization Project</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualization-project.html"><a href="visualization-project.html#industry-analysis"><i class="fa fa-check"></i><b>6.1</b> Industry analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><p><a href="https://github.com/TuozhenLiu/Advanced-Visualiztion" target="blank"><svg height="16" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github v-align-middle"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a> <a href="https://github.com/TuozhenLiu/Advanced-Visualiztion" target="blank"><strong>&nbsp Source Code</strong></a></p></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">高级统计绘图</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maps" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Maps</h1>
<p>地图毫无疑问是展示地理信息数据时最直观的工具，尤其是当地图和统计量结合时，其功效则会进一步加强。地理信息系统(GIS)已经成为研究空间和地理数据的热门工具，地图的应用也是屡见不鲜。地图的本质是多边形，而多边形的边界则由地理经纬度数据确定。</p>
<div id="maps包" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> maps包</h2>
<p>R中的附加包 maps 是目前比较完善的地图程序包之一，maps包中核心的函数为<code>map()</code>，该函数的两个主要参数为地图数据库<strong>database</strong>和地图区域<strong>region</strong>，地图数据库中包含了所有区域的经纬度数据以及相应的区域名称，在指定一个数据库和一系列区域名称之后，这些区域的地图便可由<code>map()</code>生成。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="maps.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb37-2"><a href="maps.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">usage</span>(map, <span class="at">w =</span> <span class="fl">0.8</span>)</span>
<span id="cb37-3"><a href="maps.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb37-4"><a href="maps.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">database =</span> <span class="st">&quot;world&quot;</span>, <span class="at">regions =</span> <span class="st">&quot;.&quot;</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>,</span>
<span id="cb37-5"><a href="maps.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">boundary =</span> <span class="cn">TRUE</span>, <span class="at">interior =</span> <span class="cn">TRUE</span>, <span class="at">projection =</span> <span class="st">&quot;&quot;</span>, <span class="at">parameters =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-6"><a href="maps.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">orientation =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-7"><a href="maps.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">FALSE</span>, <span class="at">namesonly =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="cn">NULL</span>, <span class="at">ylim =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-8"><a href="maps.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">resolution =</span> <span class="cf">if</span> (plot) <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb37-9"><a href="maps.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="fu">par</span>(<span class="st">&quot;bg&quot;</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fu">par</span>(<span class="st">&quot;mar&quot;</span>)[<span class="dv">3</span>], <span class="fl">0.1</span>),</span>
<span id="cb37-10"><a href="maps.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="fl">0.01</span>, ...</span>
<span id="cb37-11"><a href="maps.html#cb37-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="世界地图" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 世界地图</h3>
<p>通过运行如下代码得到世界地图。maps包里面还包括了美国、新西兰、意大利等国的地图。</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="maps.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb38-2"><a href="maps.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STKaiti&quot;</span>)</span>
<span id="cb38-3"><a href="maps.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&quot;world&quot;</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">topo.colors</span>(<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">60</span>, <span class="dv">90</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb38-4"><a href="maps.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;世界地图&quot;</span>) <span class="co"># 添加标题</span></span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="美国地图" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 美国地图</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="maps.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&quot;state&quot;</span>,</span>
<span id="cb39-2"><a href="maps.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">10</span>),</span>
<span id="cb39-3"><a href="maps.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb39-4"><a href="maps.html#cb39-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-5"><a href="maps.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STKaiti&quot;</span>)</span>
<span id="cb39-6"><a href="maps.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;美国地图&quot;</span>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>可以根据需要绘制某国地图或者美国某几个州的地图，只需在map()函数中添加选项例如<code>region = c('new york', 'new jersey', 'penn')</code> 即可。</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="maps.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="st">&quot;state&quot;</span>,</span>
<span id="cb40-2"><a href="maps.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">c</span>(<span class="st">&quot;new york&quot;</span>, <span class="st">&quot;new jersey&quot;</span>, <span class="st">&quot;penn&quot;</span>),</span>
<span id="cb40-3"><a href="maps.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">terrain.colors</span>(<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb40-4"><a href="maps.html#cb40-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-5"><a href="maps.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STKaiti&quot;</span>)</span>
<span id="cb40-6"><a href="maps.html#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;美国三州地图&quot;</span>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="中国地图" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> 中国地图</h3>
<p>在国家基础地理信息中心的网站上提供了免费的GIS数据下载，里面包括了国界与省界数据，使用R的maptools包的<code>readShapePoly()</code>或rgdal包的<code>readOGR()</code>可以读取shp文件。</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="maps.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb41-2"><a href="maps.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb41-3"><a href="maps.html#cb41-3" aria-hidden="true" tabindex="-1"></a>china <span class="ot">&lt;-</span> <span class="fu">readOGR</span>(<span class="st">&quot;china/bou2_4p.shp&quot;</span>)</span>
<span id="cb41-4"><a href="maps.html#cb41-4" aria-hidden="true" tabindex="-1"></a>china<span class="sc">@</span>data<span class="sc">$</span>NAME <span class="ot">&lt;-</span> <span class="fu">iconv</span>(china<span class="sc">@</span>data<span class="sc">$</span>NAME, <span class="st">&quot;GBK&quot;</span>, <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
<p>该数据包含了中国925个地区的的面积、周长、编号、行政区名称等信息。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="maps.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(china<span class="sc">@</span>data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    925 obs. of  7 variables:
##  $ AREA      : num  54.4 129.1 175.6 21.3 15.6 ...
##  $ PERIMETER : num  68.5 129.9 84.9 41.2 38.4 ...
##  $ BOU2_4M_  : chr  &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...
##  $ BOU2_4M_ID: chr  &quot;23&quot; &quot;15&quot; &quot;65&quot; &quot;22&quot; ...
##  $ ADCODE93  : int  230000 150000 650000 220000 210000 620000 130000 110000 210000 210000 ...
##  $ ADCODE99  : int  230000 150000 650000 220000 210000 620000 130000 110000 210000 210000 ...
##  $ NAME      : chr  &quot;黑龙江省&quot; &quot;内蒙古自治区&quot; &quot;新疆维吾尔自治区&quot; &quot;吉林省&quot; ...</code></pre>
<p>在绘制地图时，每一个省市自治区或岛屿都是用一个多边形来表示的。GIS数据提供了每一个行政区的多边形逐点的坐标，然后R通过顺次连接这些坐标，就绘制出了一个多边形区域。</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="maps.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china)</span>
<span id="cb44-2"><a href="maps.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STKaiti&quot;</span>)</span>
<span id="cb44-3"><a href="maps.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;中国地图&quot;</span>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>plot命令中的col参数在本例中应该是一个长度为 925 的向量，其第 i 个分量的取值就代表了地图中第 i 个多边形的颜色。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="maps.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china, <span class="at">col =</span> <span class="fu">gray</span>(<span class="dv">924</span><span class="sc">:</span><span class="dv">0</span> <span class="sc">/</span> <span class="dv">924</span>))</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>也可以通过查找相应的行政区对应的行名对col参数进行赋值，对相应地区进行着色：</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="maps.html#cb46-1" aria-hidden="true" tabindex="-1"></a>getColor <span class="ot">&lt;-</span> <span class="cf">function</span>(mapdata, provname, provcol, othercol) {</span>
<span id="cb46-2"><a href="maps.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">ifelse</span>(x <span class="sc">%in%</span> y, <span class="fu">which</span>(y <span class="sc">==</span> x), <span class="dv">0</span>)</span>
<span id="cb46-3"><a href="maps.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  colIndex <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mapdata<span class="sc">@</span>data<span class="sc">$</span>NAME, f, provname)</span>
<span id="cb46-4"><a href="maps.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> <span class="fu">c</span>(othercol, provcol)[colIndex <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb46-5"><a href="maps.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(col)</span>
<span id="cb46-6"><a href="maps.html#cb46-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>其中<strong>mapdata</strong>是存放地图数据的变量，<strong>provname</strong>是需要改变颜色的地区的名称，<strong>provcol</strong>是对应于<strong>provname</strong>的代表颜色的向量，<strong>othercol</strong>是其它地区的颜色。举例如下：</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="maps.html#cb47-1" aria-hidden="true" tabindex="-1"></a>provname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;北京市&quot;</span>, <span class="st">&quot;上海市&quot;</span>, <span class="st">&quot;重庆市&quot;</span>, <span class="st">&quot;福建省&quot;</span>)</span>
<span id="cb47-2"><a href="maps.html#cb47-2" aria-hidden="true" tabindex="-1"></a>provcol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb47-3"><a href="maps.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china, <span class="at">col =</span> <span class="fu">getColor</span>(china, provname, provcol, <span class="st">&quot;white&quot;</span>))</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>利用类似的方法就可以根据自己的需要对不同的区域进行着色。从国家统计局获取我国各地区的人口数据，然后根据人口的多少对各省份进行着色。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="maps.html#cb48-1" aria-hidden="true" tabindex="-1"></a>data_population <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/population.csv&quot;</span>)</span>
<span id="cb48-2"><a href="maps.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_population[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<pre><code>##       provname  pop
## 1       北京市 1633
## 2       天津市 1115
## 3       河北省 6943
## 4       山西省 3393
## 5 内蒙古自治区 2405
## 6       辽宁省 4298</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="maps.html#cb50-1" aria-hidden="true" tabindex="-1"></a>provname <span class="ot">&lt;-</span> data_population<span class="sc">$</span>provname</span>
<span id="cb50-2"><a href="maps.html#cb50-2" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> data_population<span class="sc">$</span>pop</span>
<span id="cb50-3"><a href="maps.html#cb50-3" aria-hidden="true" tabindex="-1"></a>provcol <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="dv">1</span> <span class="sc">-</span> pop <span class="sc">/</span> <span class="fu">max</span>(pop) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">green =</span> <span class="dv">1</span> <span class="sc">-</span> pop <span class="sc">/</span> <span class="fu">max</span>(pop) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">blue =</span> <span class="dv">0</span>)</span>
<span id="cb50-4"><a href="maps.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china, <span class="at">col =</span> <span class="fu">getColor</span>(china, provname, provcol, <span class="st">&quot;white&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>此外，还可以利用这个参数画出国内某一部分的地图，例如绘制福建、浙江、江西和广东四个东南地区省份的地图如下：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="maps.html#cb51-1" aria-hidden="true" tabindex="-1"></a>southeast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;福建省&quot;</span>, <span class="st">&quot;浙江省&quot;</span>, <span class="st">&quot;江西省&quot;</span>, <span class="st">&quot;广东省&quot;</span>)</span>
<span id="cb51-2"><a href="maps.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china,</span>
<span id="cb51-3"><a href="maps.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">getColor</span>(china, southeast, <span class="fu">rep</span>(<span class="st">&quot;blue&quot;</span>, <span class="dv">4</span>), <span class="st">&quot;white&quot;</span>), <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb51-4"><a href="maps.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb51-5"><a href="maps.html#cb51-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>还可以人工将各省会的信息在地图上标记出来</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="maps.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb52-2"><a href="maps.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STKaiti&quot;</span>)</span>
<span id="cb52-3"><a href="maps.html#cb52-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/city.csv&quot;</span>)</span>
<span id="cb52-4"><a href="maps.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(china, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">54</span>), <span class="at">panel.first =</span> <span class="fu">grid</span>())</span>
<span id="cb52-5"><a href="maps.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>jd, dat<span class="sc">$</span>wd, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb52-6"><a href="maps.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dat<span class="sc">$</span>jd, dat<span class="sc">$</span>wd, dat[, <span class="dv">2</span>],</span>
<span id="cb52-7"><a href="maps.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.7</span>),</span>
<span id="cb52-8"><a href="maps.html#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pos =</span> <span class="fu">c</span>(</span>
<span id="cb52-9"><a href="maps.html#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb52-10"><a href="maps.html#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span></span>
<span id="cb52-11"><a href="maps.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-12"><a href="maps.html#cb52-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-13"><a href="maps.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">0</span>)</span>
<span id="cb52-14"><a href="maps.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">0</span>)</span>
<span id="cb52-15"><a href="maps.html#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">0</span>)</span>
<span id="cb52-16"><a href="maps.html#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="pre_bookdown_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
</div>
<div id="remap包" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> REmap包</h2>
<p>REmap是一个基于Echarts的R语言程序包，为使用者提供了一个简便的、可交互的地图数据可视化工具。由于REmap目前托管在GitHub上,需要使用devtools包下载。</p>
<pre class="{.{r，eval=false}}"><code>install.packages(&#39;devtools&#39;)
library(devtools)
install_github(&#39;lchiffon/REmap&#39;)</code></pre>
<div id="获取经纬度信息" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 获取经纬度信息</h3>
<p>REmap是基于百度地图构建的，因此需要在百度地图开放平台创建项目获取AK，配置到REmap中。</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="maps.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REmap)</span>
<span id="cb54-2"><a href="maps.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">remap.ak =</span> <span class="st">&quot;ZAIIlGEpPKoBVF5M4GLEuN6G5T6AQpCn&quot;</span>) <span class="co"># 配置百度地图API</span></span>
<span id="cb54-3"><a href="maps.html#cb54-3" aria-hidden="true" tabindex="-1"></a>place <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;中央财经大学学院南路校区&quot;</span>, <span class="st">&quot;中央财经大学沙河校区&quot;</span>)</span>
<span id="cb54-4"><a href="maps.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_geo_position</span>(place)</span></code></pre></div>
<pre><code>##        lon      lat                     city
## 1 116.3492 39.96521 中央财经大学学院南路校区
## 2 116.2883 40.17780     中央财经大学沙河校区</code></pre>
</div>
<div id="获取各省市的市区级行政单位名称" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 获取各省（市）的市（区）级行政单位名称</h3>
<p>问：北京市究竟下辖哪几个区呢？</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="maps.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapNames</span>(<span class="st">&quot;北京&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;密云县&quot;   &quot;怀柔区&quot;   &quot;房山区&quot;   &quot;延庆县&quot;   &quot;门头沟区&quot; &quot;昌平区&quot;  
##  [7] &quot;大兴区&quot;   &quot;顺义区&quot;   &quot;平谷区&quot;   &quot;通州区&quot;   &quot;朝阳区&quot;   &quot;海淀区&quot;  
## [13] &quot;丰台区&quot;   &quot;石景山区&quot; &quot;西城区&quot;   &quot;东城区&quot;   &quot;宣武区&quot;   &quot;崇文区&quot;</code></pre>
</div>
<div id="地图可视化" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 地图可视化</h3>
<div id="remap函数绘制航迹图" class="section level4" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> remap函数绘制航迹图</h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="maps.html#cb58-1" aria-hidden="true" tabindex="-1"></a>origin <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;北京&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb58-2"><a href="maps.html#cb58-2" aria-hidden="true" tabindex="-1"></a>destination <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb58-3"><a href="maps.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;上海&quot;</span>, <span class="st">&quot;广州&quot;</span>, <span class="st">&quot;大连&quot;</span>, <span class="st">&quot;南宁&quot;</span>, <span class="st">&quot;南昌&quot;</span>,</span>
<span id="cb58-4"><a href="maps.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;拉萨&quot;</span>, <span class="st">&quot;长春&quot;</span>, <span class="st">&quot;包头&quot;</span>, <span class="st">&quot;重庆&quot;</span>, <span class="st">&quot;常州&quot;</span></span>
<span id="cb58-5"><a href="maps.html#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-6"><a href="maps.html#cb58-6" aria-hidden="true" tabindex="-1"></a>flight <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(origin, destination)</span>
<span id="cb58-7"><a href="maps.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">remap</span>(flight, <span class="at">title =</span> <span class="st">&quot;航迹图&quot;</span>, <span class="at">theme =</span> <span class="fu">get_theme</span>(<span class="st">&quot;Dark&quot;</span>))</span></code></pre></div>
<script src="./js/echarts.js"></script>
<script src = "./js/echarts-all.js"></script>
<div id="remap" style="width: 700px; height:466px;"></div>
<script>
  var myChart = echarts.init(document.getElementById("remap"));

  var option = 
{
  backgroundColor: '#1b1b1b',
  color: ['gold','aqua','lime'],
  title : {
  text: 'REmap实例数据',
  subtext:'theme:Dark',
  x:'center',
  textStyle : {
  color: '#fff'
  }
  },
  tooltip : {
  trigger: 'item',
  formatter: '{b}'
  },
  toolbox: {
  show : true,
  orient : 'vertical',
  x: 'right',
  y: 'center',
  feature : {
  mark : {show: true},
  dataView : {show: true, readOnly: false},
  restore : {show: true},
  saveAsImage : {show: true}
  }
  },
  dataRange: {
  min : 0,
  show: false,
  max : 100,
  y: '60%',
  calculable : true,
  color: ['#ff3333', 'orange', 'yellow','lime','aqua']
  },

  series : [
  {
  type:'map',
  itemStyle:{
  normal:{
  borderColor:'rgba(100,149,237,1)',
  borderWidth: 0.5,
  areaStyle:{
  color: '#1b1b1b'
  }
  }
  },
  data:[],
  geoCoord: {'北京': [116.413554,39.911013],
'上海': [121.480237,31.236305],
'广州': [113.270793,23.135308],
'大连': [121.621391,38.919345],
'南宁': [108.373351,22.823037],
'南昌': [115.864528,28.687675],
'拉萨': [91.121025,29.650088],
'长春': [125.33017,43.82178],
'包头': [109.846755,40.663636],
'重庆': [106.557165,29.570997],
'常州': [119.58,31.47]},

  markLine : {
  smooth:true,
  effect : {
  show: true,
  scaleSize: 1,
  period: 30,
  color: '#fff',
  shadowBlur: 10
  },
  itemStyle : {
  color: 'red',
  normal: {
  borderWidth:1,
  lineStyle: {
  type: 'solid',
  shadowBlur: 10
  },
  label:{show:false}
  }
  },

  data : [
  [{name:'北京'}, {name:'上海',value: 90}],
[{name:'北京'}, {name:'广州',value: 70}],
[{name:'北京'}, {name:'大连',value: 70}],
[{name:'北京'}, {name:'南宁',value: 20}],
[{name:'北京'}, {name:'南昌',value: 80}],
[{name:'北京'}, {name:'拉萨',value: 80}],
[{name:'北京'}, {name:'长春',value: 20}],
[{name:'北京'}, {name:'包头',value: 30}],
[{name:'北京'}, {name:'重庆',value: 20}],
[{name:'北京'}, {name:'常州',value:100}]
  ]
  },
  markPoint : {
  symbol:'emptyCircle',
  symbolSize : function (v){
  return 10 + v/10
  },
  effect : {
  show: true,
  shadowBlur : 0
  },
  itemStyle:{
  normal:{
  label:{show:true}
  }
  },
  data : [
  {name:'上海',value: 90},
{name:'广州',value: 70},
{name:'大连',value: 70},
{name:'南宁',value: 20},
{name:'南昌',value: 80},
{name:'拉萨',value: 80},
{name:'长春',value: 20},
{name:'包头',value: 30},
{name:'重庆',value: 20},
{name:'常州',value:100}
  ]
  }
  }
  ]
  }
;
myChart.setOption(option);
</script>
<p>图中的颜色可以通过<code>get_theme()</code>来设置，几个常用的参数：<br />
</p>
<p><strong>Theme:theme</strong>是总体配色选项，共有’Dark’,‘Bright’,‘Sky’,‘None’四种选项。选定该选项（除’None’外）后，其它参数无需再设置。<br />
<strong>lineColor</strong>: lineColor为线条颜色，默认是随机，也可自行设置，如’red’。<br />
<strong>BackgroundColor</strong>:地图外背景颜色<br />
<strong>RegionColor</strong>:地图中各区域颜色</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="maps.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_theme</span>(</span>
<span id="cb59-2"><a href="maps.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="st">&quot;Dark&quot;</span>,</span>
<span id="cb59-3"><a href="maps.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineColor =</span> <span class="st">&quot;Random&quot;</span>,</span>
<span id="cb59-4"><a href="maps.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundColor =</span> <span class="st">&quot;#1b1b1b&quot;</span>,</span>
<span id="cb59-5"><a href="maps.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">titleColor =</span> <span class="st">&quot;#fff&quot;</span>,</span>
<span id="cb59-6"><a href="maps.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">borderColor =</span> <span class="st">&quot;rgba(100,149,237,1)&quot;</span>,</span>
<span id="cb59-7"><a href="maps.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionColor =</span> <span class="st">&quot;#1b1b1b&quot;</span>,</span>
<span id="cb59-8"><a href="maps.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelShow =</span> T,</span>
<span id="cb59-9"><a href="maps.html#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointShow =</span> F,</span>
<span id="cb59-10"><a href="maps.html#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointColor =</span> <span class="st">&quot;gold&quot;</span></span>
<span id="cb59-11"><a href="maps.html#cb59-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>例如将颜色改为亮色：</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="maps.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remap</span>(flight, <span class="at">title =</span> <span class="st">&quot;亮色航迹图&quot;</span>, <span class="at">theme =</span> <span class="fu">get_theme</span>(<span class="st">&quot;Bright&quot;</span>))</span></code></pre></div>
<div id="main2" style="width: 700px; height:466px;"></div>
  <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
  <script src = "http://echarts.baidu.com/build/dist/echarts-all.js"></script>
  <script>
  var myChart = echarts.init(document.getElementById("main2"));

  var optionID_20211223000944_48477 = 
{
  backgroundColor: '#D9D9D9',
  color: ['gold','aqua','lime'],
  title : {
  text: '亮色航迹图',
  subtext:'',
  x:'center',
  textStyle : {
  color: '#1b1b1b'
  }
  },
  tooltip : {
  trigger: 'item',
  formatter: '{b}'
  },
  toolbox: {
  show : true,
  orient : 'vertical',
  x: 'right',
  y: 'center',
  feature : {
  mark : {show: true},
  dataView : {show: true, readOnly: false},
  restore : {show: true},
  saveAsImage : {show: true}
  }
  },
  dataRange: {
  min : 0,
  show: false,
  max : 100,
  y: '60%',
  calculable : true,
  color: ['#ff3333', 'orange', 'yellow','lime','aqua']
  },

  series : [
  {
  type:'map',
  itemStyle:{
  normal:{
  borderColor:'rgba(100,149,237,1)',
  borderWidth: 0.5,
  areaStyle:{
  color: '#fff'
  }
  }
  },
  data:[],
  geoCoord: {'北京': [116.413554,39.911013],
'上海': [121.480237,31.236305],
'广州': [113.270793,23.135308],
'大连': [121.621391,38.919345],
'南宁': [108.373351,22.823037],
'南昌': [115.864528,28.687675],
'拉萨': [91.121025,29.650088],
'长春': [125.33017,43.82178],
'包头': [109.846755,40.663636],
'重庆': [106.557165,29.570997],
'常州': [119.58,31.47]},

  markLine : {
  smooth:true,
  effect : {
  show: true,
  scaleSize: 1,
  period: 30,
  color: '#fff',
  shadowBlur: 10
  },
  itemStyle : {
  color: 'red',
  normal: {
  borderWidth:1,
  lineStyle: {
  type: 'solid',
  shadowBlur: 10
  },
  label:{show:false}
  }
  },

  data : [
  [{name:'北京'}, {name:'上海',value: 10}],
[{name:'北京'}, {name:'广州',value: 50}],
[{name:'北京'}, {name:'大连',value: 10}],
[{name:'北京'}, {name:'南宁',value: 90}],
[{name:'北京'}, {name:'南昌',value:100}],
[{name:'北京'}, {name:'拉萨',value: 80}],
[{name:'北京'}, {name:'长春',value: 50}],
[{name:'北京'}, {name:'包头',value: 80}],
[{name:'北京'}, {name:'重庆',value:  0}],
[{name:'北京'}, {name:'常州',value:100}]
  ]
  },
  markPoint : {
  symbol:'emptyCircle',
  symbolSize : function (v){
  return 10 + v/10
  },
  effect : {
  show: true,
  shadowBlur : 0
  },
  itemStyle:{
  normal:{
  label:{show:true}
  }
  },
  data : [
  {name:'上海',value: 10},
{name:'广州',value: 50},
{name:'大连',value: 10},
{name:'南宁',value: 90},
{name:'南昌',value:100},
{name:'拉萨',value: 80},
{name:'长春',value: 50},
{name:'包头',value: 80},
{name:'重庆',value:  0},
{name:'常州',value:100}
  ]
  }
  }
  ]
  }
;
  myChart.setOption(optionID_20211223000944_48477);
  </script>
</div>
<div id="remaph绘制热力效果图" class="section level4" number="4.2.3.2">
<h4><span class="header-section-number">4.2.3.2</span> remapH绘制热力效果图</h4>
<p>这个函数的特点是可以做中心辐射的热力图，这种热力图在气象、人口密度、海拔测绘领域有诸多运用，当然也可以上当用在商务场合——特别是跟地理信息有关的数据呈现方面。<br />
<code>remapH()</code>的各参数如下：</p>
<pre class="{.{r，eval=false}}"><code>remapH(data,
       maptype = &#39;china&#39;,
       theme = get_theme(&quot;Dark&quot;),
       blurSize = 30,
       color = c(&#39;blue&#39;),
       minAlpha = 0.05,
       opacity = 1,
           )</code></pre>
<p><strong>data</strong>为要传入的数据，数据为三列，第一列为lon(经度)，第二列为lat(维度)，第三列为prob(密度/概率)<br />
<strong>maptype</strong>为要绘制的地图类型，可选有：“china”，“world”或中国各省份名字<br />
<strong>theme</strong>为绘制的地图主题类型，可由get_theme函数传入，get_theme在下面会详解<br />
<strong>blurSize</strong>为热力效果的泛化范围，可调整热力点中心的扩散程度<br />
<strong>color</strong>为热力的渐变颜色<br />
<strong>minAlpha</strong>为热力点的展示阈值，对应data中的prob列，作图时各点密度会对比minAlpha，以凸显不同密度所展示的不同热力分布<br />
<strong>opacity</strong>为透明度，调整热力图的透明度</p>
<p>获取200个城市的PM2.5指数及经纬度，绘制热力图如下：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="maps.html#cb62-1" aria-hidden="true" tabindex="-1"></a>air <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/air.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb62-2"><a href="maps.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(air)</span></code></pre></div>
<pre><code>##        lon      lat avg_pm2_5
## 1 121.3857 41.05955 0.3618444
## 2 113.4990 22.28592 0.1763897
## 3 119.9574 36.78975 0.3056141
## 4 114.9962 30.20217 0.3327429
## 5 117.5387 36.70130 0.4373493
## 6 129.0924 47.97323 0.1041234</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="maps.html#cb64-1" aria-hidden="true" tabindex="-1"></a>theme1 <span class="ot">&lt;-</span> <span class="fu">get_theme</span>(</span>
<span id="cb64-2"><a href="maps.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb64-3"><a href="maps.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineColor =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb64-4"><a href="maps.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundColor =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb64-5"><a href="maps.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">titleColor =</span> <span class="st">&quot;#fff&quot;</span>,</span>
<span id="cb64-6"><a href="maps.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">borderColor =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb64-7"><a href="maps.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionColor =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb64-8"><a href="maps.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelShow =</span> T,</span>
<span id="cb64-9"><a href="maps.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointShow =</span> F,</span>
<span id="cb64-10"><a href="maps.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointColor =</span> <span class="st">&quot;gold&quot;</span></span>
<span id="cb64-11"><a href="maps.html#cb64-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-12"><a href="maps.html#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="fu">remapH</span>(air,</span>
<span id="cb64-13"><a href="maps.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">maptype =</span> <span class="st">&quot;china&quot;</span>,</span>
<span id="cb64-14"><a href="maps.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> theme1,</span>
<span id="cb64-15"><a href="maps.html#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">blurSize =</span> <span class="dv">35</span>,</span>
<span id="cb64-16"><a href="maps.html#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb64-17"><a href="maps.html#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">minAlpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb64-18"><a href="maps.html#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb64-19"><a href="maps.html#cb64-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="main3" style="width: 700px; height:466px;"></div>
  <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
  <script src = "http://echarts.baidu.com/build/dist/echarts-all.js"></script>
  <script>
  var myChart = echarts.init(document.getElementById("main3"));

  var heatData = [[121.3856774,41.05954614,0.361844359],
[113.499,22.285925,0.176389739],
[119.957365,36.78975,0.305614096],
[114.9962023,30.20217391,0.332742944],
[117.5387,36.7013,0.437349314],
[129.0924,47.97323333,0.10412342],
[116.7973,33.94026667,0.493282954],
[118.3739583,31.36784725,0.405229683],
[111.1328778,37.5149,0.426686722],
[125.94235,41.72685,0.195418195],
[114.0090185,32.98931481,0.510218519],
[111.47422,27.25482,0.3523319],
[106.7017971,26.55266858,0.217918015],
[110.4822747,29.22293975,0.211735979],
[91.7657,29.24615,0.015605062],
[117.4857,30.65853333,0.361189831],
[120.2750333,31.91430667,0.427108525],
[117.702063,36.2182926,0.592356608],
[109.97888,27.55854,0.249500856],
[103.21015,35.6018,0.365401998],
[103.7602,29.5738,0.368273556],
[114.4002111,36.08646667,0.646696818],
[119.9036111,32.43243056,0.394203963],
[109.4273055,24.32704618,0.314673914],
[114.8956,40.817,0.231101555],
[97,33.0014,0.06942812],
[114.92238,25.86134,0.288262013],
[111.2757,23.46215,0.276868645],
[115.3611667,38.786875,0.552973157],
[112.20255,31.0275086,0.469695419],
[118.3399451,35.05247506,0.420285044],
[114.8966278,30.4619111,0.319583177],
[102.2125,31.90816667,0.034588326],
[92.0581,31.47895,0.221676099],
[116.6398084,25.67351995,0.236646553],
[126.6518092,45.74024885,0.304476193],
[107.35885,22.39225,0.220608119],
[105.8648333,34.49786667,0.269653646],
[104.6405,30.133,0.275700127],
[94.36485,29.6504,0],
[122.83275,45.6232,0.192125774],
[106.1848295,37.97544487,0.295655776],
[112.5159,37.8505625,0.470051491],
[123.0427028,41.11737633,0.275557485],
[116.0003323,29.67551289,0.306589626],
[100.9048,36.9639,0.153774963],
[100.2281,26.87613333,0.073216344],
[102.9064746,35.0015277,0.210931686],
[118.8656667,28.96043333,0.239980557],
[113.8148148,34.01277778,0.547267454],
[116.72725,39.54475,0.427514772],
[107.52278,26.24056,0.16512164],
[124.12445,50.4243,0.091976458],
[120.8591732,40.7408054,0.322997957],
[122.207,29.99016667,0.131600691],
[99.16945,25.12045,0.126209664],
[102.27516,27.8656,0.120921112],
[94.45790667,29.73098667,0.540262298],
[104.1731,36.54695,0.284735718],
[117.127718,36.189343,0.429389218],
[103.85665,30.067125,0.277789072],
[104.61985,35.58445,0.313172542],
[114.3783,27.79756,0.298866361],
[98.85735,25.8492,0.155381126],
[115.0403889,35.76605556,0.552190411],
[89.1673,42.9559,0.462690952],
[115.6554861,34.41665278,0.533388119],
[108.321375,22.8033,0.240100229],
[105.8491,32.437375,0.176404618],
[106.1539667,38.503855,0.301294091],
[120.0845834,29.3201639,0.256681058],
[118.4607933,24.76495925,0.157219401],
[120.0172643,36.26762435,0.332289661],
[113.3925,22.5164,0.196285147],
[104.891665,25.095835,0.056801813],
[79.9301,37.10825,1],
[125.14625,42.895,0.252253768],
[122.4209,37.161475,0.143867451],
[104.86438,26.58296,0.237888976],
[102.1086,36.4997,0.347234708],
[121.53885,36.9214,0.143116394],
[114.2511111,35.79453704,0.467080849],
[119.6068,39.9362,0.291492791],
[113.151641,29.3886245,0.347637607],
[118.76175,36.86375,0.445101988],
[118.1165417,24.5639,0.151160678],
[113.3507659,23.18525019,0.250253646],
[106.2536196,36.0493382,0.257984263],
[115.4553147,35.25411733,0.513913283],
[110.37,20.00918,0.082555733],
[120.8715,31.99383333,0.320833038],
[122.0792726,37.49314812,0.180827834],
[97.3731,37.3753,0.129142687],
[116.9708459,33.63858378,0.488180577],
[113.0516005,23.67654793,0.276793275],
[118.183,39.64516667,0.512332589],
[103.005325,29.99185,0.328914275],
[123.2053014,41.24151322,0.270132052],
[91.79549474,29.46273684,0.383791714],
[111.9622547,21.857164,0.211492658],
[119.4238095,32.39417506,0.39654542],
[118.155875,26.64825,0.125757928],
[120.453895,36.38699,0.250059343],
[124.3675667,43.17293333,0.295293928],
[117.3568167,32.92925,0.445885318],
[113.6533408,34.77363367,0.564116459],
[106.5097068,29.59513735,0.285872145],
[104.2426,23.3743,0.168501922],
[121.1650664,31.89429563,0.253545742],
[105.5761,30.52185,0.270561716],
[110.1404667,22.65313333,0.268762437],
[130.97095,45.2975,0.215436921],
[120.0819091,30.21117273,0.28973021],
[119.7066667,30.23430555,0.274601563],
[122.0361,37.19165,0.147223292],
[120.739535,31.65705,0.364421664],
[123.4613451,41.80196455,0.287448846],
[113.0655,22.9843,0.246468412],
[106.0862167,30.80306667,0.36298517],
[111.1724167,34.78828611,0.482253404],
[113.5925554,24.7721666,0.25944703],
[112.3611,28.59404,0.252660897],
[100.45915,38.9428,0.27919011],
[115.8247,32.8797,0.454202198],
[117.0201,25.079525,0.170155863],
[119.16638,31.95072,0.426827949],
[86.0597,44.3021,0.532503548],
[119.6621,29.09756667,0.250581608],
[120.6516067,31.16692333,0.302864933],
[119.810115,31.35882,0.348610425],
[105.1250212,37.32008363,0.285641514],
[113.1619833,27.86096171,0.339044551],
[110.2997222,25.25290278,0.277536222],
[113.3779518,31.71665553,0.345546326],
[111.5095196,36.072762,0.579169637],
[119.9675,37.19,0.244320578],
[126.5600317,43.855992,0.259225011],
[106.68655,35.53775,0.27535515],
[120.3038766,31.55509637,0.32642495],
[114.6569792,33.61469445,0.503702118],
[112.48375,23.090925,0.274931376],
[121.6275,29.8703625,0.234274148],
[120.402525,37.370045,0.238332432],
[124.9233334,46.4433332,0.182208345],
[117.2478,31.84824,0.38813309],
[103.3796667,23.39476667,0.164425194],
[120.4419677,41.6128048,0.290071237],
[114.6438667,38.01513333,0.588943182],
[107.00515,33.100225,0.361665063],
[111.6653375,40.8014625,0.293985988],
[120.6855,27.99855,0.214223301],
[115.363426,22.78472233,0.137629995],
[98.50565,39.7377,0.239375394],
[116.33628,27.99942,0.27114395],
[121.6278,38.94953,0.208261119],
[114.7536813,23.72685863,0.187490912],
[87.5475,44.1756,0.603671373],
[117.0250245,30.55412449,0.369171052],
[109.9082667,40.62778333,0.308479361],
[112.4312,39.34474,0.343359594],
[108.1227667,24.70053333,0.202302681],
[116.6198449,35.42655207,0.449137257],
[116.3018055,37.45422234,0.482302363],
[117.3378685,39.10484162,0.433147147],
[120.3868851,36.11952267,0.253097698],
[118.0001852,37.37444444,0.472927328],
[117.810573,30.93106622,0.390083629],
[111.7072224,28.9914224,0.329738659],
[119.359,26.07511667,0.149103741],
[106.6315,23.89275,0.268012357],
[79.49984848,25.11784361,0.576706121],
[122.0324103,46.07575433,0.114996331],
[87.2857,44.02055,0.521901693],
[115.9940887,36.45236048,0.51927925],
[113.5622667,37.8607,0.504968564],
[105.298195,27.30139,0.23870501],
[113.12606,41.0196595,0.167786326],
[111.0160644,35.05303778,0.513188312],
[115.8841111,28.70373333,0.194886452],
[112.8463833,35.50058333,0.513163031],
[101.6903694,26.56361018,0.245821966],
[109.1636808,21.47291675,0.191507948],
[120.52985,36.8764,0.322548251],
[117.6673667,24.49636667,0.213571494],
[119.04232,25.43068,0.170313826],
[113.2339682,35.22121548,0.571508016],
[113.071,22.578475,0.21289301],
[112.5933333,26.90018333,0.334965134],
[112.7288611,37.70111945,0.445048487],
[114.2352773,30.56543445,0.383189616],
[104.6162167,28.7696,0.415408052],
[112.043333,22.936759,0.225845417],
[119.5077084,32.18520834,0.448865375],
[116.8695333,32.6531,0.462722711],
[105.061975,29.59215,0.282588233],
[112.7247333,38.45443333,0.436083361],
[127.4716,50.24716667,0.094734578],
[120.54215,31.8722,0.316335983],
[101.5431,25.04665,0.150520612],
[112.9846,28.20576,0.369988853]];
  var optionID_20211223001405_74556 =
  {

  backgroundColor: 'white',
  color: ['gold','aqua','lime'],
  title : {
  text: '',
  subtext:'',
  x:'center',
  textStyle : {
  color: '#fff'
  }
  },
  tooltip : {
  trigger: 'item',
  formatter: function (v) {
  if(v[2].tooltipValue!=null){
  return v[2].tooltipvalue;
  }else{
  return v[1];
  }
  }},
  dataRange: {
    show: false,
    min : 0,
    max : 100,
    calculable : true,
    color: ['#ff3333', 'orange', 'yellow','lime','aqua'],
    textStyle:{
      color:'#fff'
    }
  },
  legend: {
  show:false,
  orient: 'vertical',
  x:'left',
  data:['Data'],
  textStyle:{color:'backgroundColorData'}

  },
  toolbox: {
  show : true,
  orient : 'vertical',
  x: 'right',
  y: 'center',
  feature : {
  mark : {show: true},
  dataView : {show: true, readOnly: false},
  restore : {show: true},
  saveAsImage : {show: true}
  }
  },
  series : [
  {
  name:'Data',
  type:'map',
  mapType: 'china',
  roam: true,
  itemStyle:{
  normal:{
  borderColor:'blue',
  borderWidth: 0.5,
  label:{show:true,textStyle:{color:'#fff'}},
  areaStyle: {color: 'backgroundColorData'}
  },
  emphasis:{label:{show:true,textStyle:{color:'#fff'}}}
  },
  data:[]
  ,heatmap: {
                      blurSize:35 ,
                      colors:['red', 'white'] ,
                      minAlpha:0.3 ,
                      opacity:1 ,
                      data: heatData}
  
  
  }]
  }
;
  myChart.setOption(optionID_20211223001405_74556);
  </script>
</div>
<div id="remapc绘制填充地图" class="section level4" number="4.2.3.3">
<h4><span class="header-section-number">4.2.3.3</span> remapC绘制填充地图</h4>
<p><code>remapC()</code>允许我们同时在一张地图上制作填充图和点图、线图。</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="maps.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remapC</span>(data,</span>
<span id="cb65-2"><a href="maps.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">maptype =</span> <span class="st">&quot;china&quot;</span>,</span>
<span id="cb65-3"><a href="maps.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">markLineData =</span> <span class="cn">NULL</span>,</span>
<span id="cb65-4"><a href="maps.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">markPointData =</span> <span class="cn">NULL</span>,</span>
<span id="cb65-5"><a href="maps.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;#1e90ff&quot;</span>, <span class="st">&quot;#f0ffff&quot;</span>),</span>
<span id="cb65-6"><a href="maps.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">get_theme</span>(<span class="st">&quot;Bright&quot;</span>),</span>
<span id="cb65-7"><a href="maps.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb65-8"><a href="maps.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb65-9"><a href="maps.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">markLineTheme =</span> <span class="fu">markLineControl</span>(),</span>
<span id="cb65-10"><a href="maps.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">markPointTheme =</span> <span class="fu">markPointControl</span>(),</span>
<span id="cb65-11"><a href="maps.html#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">geoData =</span> <span class="cn">NA</span>,</span>
<span id="cb65-12"><a href="maps.html#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mindata =</span> <span class="cn">NA</span>,</span>
<span id="cb65-13"><a href="maps.html#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxdata =</span> <span class="cn">NA</span></span>
<span id="cb65-14"><a href="maps.html#cb65-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>主要参数：<br />
<strong>data</strong>为需要的原始数据框格式数据，共2列，第一列为省份或者城市名称，第二列为对应的数值，数值大小将决定地图颜色深浅。<br />
<strong>maptype</strong>为地图类型设置，可选world、china或者中国省份名称<br />
<strong>color</strong>为热力图渐变颜色，默认为2个颜色，第一个为终止色，第二个为初始色<br />
<strong>mindata</strong>与<strong>maxdata</strong>可以设置颜色极端点对应数据的上下限（默认是使用data中的数据最大值最小值作为两端极值）。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="maps.html#cb66-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> <span class="fu">mapNames</span>(<span class="st">&quot;china&quot;</span>) <span class="co"># 全国省份</span></span>
<span id="cb66-2"><a href="maps.html#cb66-2" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">34</span>, <span class="dv">100</span>, <span class="dv">30</span>) <span class="co"># 随机生成分省值</span></span>
<span id="cb66-3"><a href="maps.html#cb66-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(province, value) <span class="co"># 合成数据框作图数据</span></span>
<span id="cb66-4"><a href="maps.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">remapC</span>(mydata,</span>
<span id="cb66-5"><a href="maps.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">maptype =</span> <span class="st">&quot;China&quot;</span>, <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb66-6"><a href="maps.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;全国分省图&quot;</span></span>
<span id="cb66-7"><a href="maps.html#cb66-7" aria-hidden="true" tabindex="-1"></a>) <span class="co"># 制作等级图</span></span></code></pre></div>
<div id="main4" style="width: 700px; height:466px;"></div>
  <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
  <script src = "http://echarts.baidu.com/build/dist/echarts-all.js"></script>
  <script>
  var myChart = echarts.init(document.getElementById("main4"));

  var optionID_20211223002124_118480 = 
{
  backgroundColor: '#D9D9D9',
  color: ['gold','aqua','lime'],
  title : {
    text: '全国分省图',
    subtext:'',
    x:'center',
    textStyle : {
      color: '#1b1b1b'
    }
  },
  tooltip : {
    trigger: 'item',
    formatter: function (v) {
            if(typeof(v[2])=='number'){
            return(v[1]+': '+v[2])
            }else if(v[2].tooltipValue!=null){
            return v[2].tooltipValue;
          }else{
            return v[1];
          }
  }},
    legend: {
        show:false,
        orient: 'vertical',
        x:'left',
        data:['Data'],
        textStyle:{color:'#D9D9D9'}

    },
  toolbox: {
    show : true,
    orient : 'vertical',
    x: 'right',
    y: 'center',
    feature : {
      mark : {show: true},
      dataView : {show: true, readOnly: false},
      restore : {show: true},
      saveAsImage : {show: true}
    }
  },
  dataRange: {
    min : 22,
    max : 209,
    calculable : true,
    color: ['yellow', 'red'],
    textStyle:{
      color:'#1b1b1b'
    }
  },
  series : [
    {
    name:'Data',
    type:'map',
    mapType: 'china',
    itemStyle:{
    normal:{
    borderColor:'rgba(100,149,237,1)',
    borderWidth: 0.5,
    label:{show:true,textStyle:{color:'#1b1b1b'}},
    },
    emphasis:{label:{show:true,textStyle:{color:'#1b1b1b'}}}
  },
  data:[{name:'新疆',value: 99.16015},
        {name:'西藏',value: 96.01056},
        {name:'内蒙古',value:122.37526},
        {name:'青海',value: 96.69881},
        {name:'四川',value:116.71160},
        {name:'黑龙江',value:125.68131},
        {name:'甘肃',value: 32.68334},
        {name:'云南',value: 73.88564},
        {name:'广西',value:197.66872},
        {name:'湖南',value: 68.46319},
        {name:'陕西',value: 98.68463},
        {name:'广东',value:134.47487},
        {name:'吉林',value:127.04263},
        {name:'河北',value: 70.04408},
        {name:'湖北',value:117.02832},
        {name:'贵州',value: 93.24028},
        {name:'山东',value: 77.15386},
        {name:'江西',value:132.52203},
        {name:'河南',value: 58.84273},
        {name:'辽宁',value:119.98721},
        {name:'山西',value: 54.37361},
        {name:'安徽',value:125.20147},
        {name:'福建',value: 47.02378},
        {name:'浙江',value: 63.84055},
        {name:'江苏',value: 61.34687},
        {name:'重庆',value:100.89941},
        {name:'宁夏',value: 92.69678},
        {name:'海南',value:155.51616},
        {name:'台湾',value: 71.73297},
        {name:'北京',value: 60.77722},
        {name:'天津',value:116.54781},
        {name:'上海',value:115.86285},
        {name:'香港',value:128.03343},
        {name:'澳门',value:130.82322}]
  
  
  }]
}
;
  myChart.setOption(optionID_20211223002124_118480);
  </script>
<p>模拟出广东省回流各省的人口数，使用填色地图表示人流规模，使用动态流向线表示回流最大的前10个省份。</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="maps.html#cb67-1" aria-hidden="true" tabindex="-1"></a>province <span class="ot">&lt;-</span> <span class="fu">mapNames</span>(<span class="st">&quot;china&quot;</span>) <span class="co"># 全国省份</span></span>
<span id="cb67-2"><a href="maps.html#cb67-2" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">34</span>, <span class="dv">1000</span>, <span class="dv">30</span>), <span class="dv">0</span>) <span class="co"># 随机生成分省值</span></span>
<span id="cb67-3"><a href="maps.html#cb67-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(province, value) <span class="co"># 合并数据</span></span>
<span id="cb67-4"><a href="maps.html#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="maps.html#cb67-5" aria-hidden="true" tabindex="-1"></a>lableper <span class="ot">&lt;-</span> mydata[<span class="fu">order</span>(mydata[, <span class="st">&quot;value&quot;</span>], <span class="at">decreasing =</span> T), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb67-6"><a href="maps.html#cb67-6" aria-hidden="true" tabindex="-1"></a>origin <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;广州&quot;</span>, <span class="fu">length</span>(lableper))</span>
<span id="cb67-7"><a href="maps.html#cb67-7" aria-hidden="true" tabindex="-1"></a>destination <span class="ot">&lt;-</span> lableper<span class="sc">$</span>province</span>
<span id="cb67-8"><a href="maps.html#cb67-8" aria-hidden="true" tabindex="-1"></a>line_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(origin, destination)</span>
<span id="cb67-9"><a href="maps.html#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="maps.html#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">remapC</span>(mydata,</span>
<span id="cb67-11"><a href="maps.html#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;广东省人口迁徙地图&quot;</span>,</span>
<span id="cb67-12"><a href="maps.html#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">get_theme</span>(<span class="st">&quot;Dark&quot;</span>),</span>
<span id="cb67-13"><a href="maps.html#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;#CD0000&quot;</span>, <span class="st">&quot;#FFEC8B&quot;</span>),</span>
<span id="cb67-14"><a href="maps.html#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">markLineData =</span> line_data,</span>
<span id="cb67-15"><a href="maps.html#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">markLineTheme =</span> <span class="fu">markLineControl</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">lineWidth =</span> <span class="dv">2</span>, <span class="at">lineType =</span> <span class="st">&quot;dashed&quot;</span>),</span>
<span id="cb67-16"><a href="maps.html#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">markPointData =</span> line_data[<span class="dv">2</span>],</span>
<span id="cb67-17"><a href="maps.html#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">markPointTheme =</span> <span class="fu">markPointControl</span>(</span>
<span id="cb67-18"><a href="maps.html#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">symbolSize =</span> <span class="dv">13</span>, <span class="at">effect =</span> T, <span class="at">effectType =</span> <span class="st">&quot;scale&quot;</span>,</span>
<span id="cb67-19"><a href="maps.html#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb67-20"><a href="maps.html#cb67-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div id="main5" style="width: 700px; height:466px;"></div>
  <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
  <script src = "http://echarts.baidu.com/build/dist/echarts-all.js"></script>
  <script>
  var myChart = echarts.init(document.getElementById("main5"));

  var optionID_20211223002722_1789 =
{
  backgroundColor: '#1b1b1b',
  color: ['gold','aqua','lime'],
  title : {
    text: '广东省人口迁徙地图',
    subtext:'',
    x:'center',
    textStyle : {
      color: '#fff'
    }
  },
  tooltip : {
    trigger: 'item',
    formatter: function (v) {
         if(typeof(v[2])=='number'){
         return(v[1]+': '+v[2])
         }else if(v[2].tooltipValue!=null){
             return v[2].tooltipValue;
          }else{
            return v[1];
          }
  }},
    legend: {
        show:false,
        orient: 'vertical',
        x:'left',
        data:['Data'],
         textStyle:{color:'#1b1b1b'}

    },
  toolbox: {
    show : true,
    orient : 'vertical',
    x: 'right',
    y: 'center',
    feature : {
      mark : {show: true},
      dataView : {show: true, readOnly: false},
      restore : {show: true},
      saveAsImage : {show: true}
    }
  },
  dataRange: {
    min : 937,
    max : 1035,
    calculable : true,
    color: ['#CD0000', '#FFEC8B'],
    textStyle:{
      color:'#fff'
    }
  },
  series : [
    {
    name:'Data',
    type:'map',
    mapType: 'china',
    itemStyle:{
    normal:{
    borderColor:'rgba(100,149,237,1)',
    borderWidth: 0.5,
    label:{show:true,textStyle:{color:'#fff'}},
    },
    emphasis:{label:{show:true,textStyle:{color:'#fff'}}}
  },
  data:[{name:'新疆',value: 966},
     {name:'西藏',value: 946},
     {name:'内蒙古',value: 974},
     {name:'青海',value: 961},
     {name:'四川',value: 943},
     {name:'黑龙江',value:1001},
     {name:'甘肃',value: 964},
     {name:'云南',value:1011},
     {name:'广西',value:1000},
     {name:'湖南',value: 982},
     {name:'陕西',value:1005},
     {name:'广东',value: 986},
     {name:'吉林',value: 981},
     {name:'河北',value:1028},
     {name:'湖北',value: 988},
     {name:'贵州',value: 994},
     {name:'山东',value:1012},
     {name:'江西',value:1008},
     {name:'河南',value: 995},
     {name:'辽宁',value:1024},
     {name:'山西',value: 962},
     {name:'安徽',value: 989},
     {name:'福建',value: 958},
     {name:'浙江',value:1004},
     {name:'江苏',value: 988},
     {name:'重庆',value: 971},
     {name:'宁夏',value:1003},
     {name:'海南',value: 966},
     {name:'台湾',value:1004},
     {name:'北京',value: 945},
     {name:'天津',value: 966},
     {name:'上海',value:1029},
     {name:'香港',value:1017},
     {name:'澳门',value: 955}]

  ,markLine : {
    Symbol:['none', 'arrow'],
    symbolSize:['2', '4'],
    smooth:true,
    smooth:0.2,
    effect : {
      show: true,
      scaleSize: 1,
      period: 30,
      color: '#fff',
      shadowBlur: 10
    },
    itemStyle : {
      color: 'red',
      normal: {
        color:'white',
        borderWidth:1,
        lineStyle: {
          type: 'dashed',
          width: 2,
          shadowBlur: 10
        },
        label:{show:false}
      }
    },

    data : [[{name:'广州'}, {name:'上海',value:49}],
[{name:'广州'}, {name:'河北',value:76}],
[{name:'广州'}, {name:'辽宁',value:88}],
[{name:'广州'}, {name:'香港',value:43}],
[{name:'广州'}, {name:'山东',value:46}],
[{name:'广州'}, {name:'云南',value:25}],
[{name:'广州'}, {name:'江西',value: 9}],
[{name:'广州'}, {name:'陕西',value:14}],
[{name:'广州'}, {name:'浙江',value:35}],
[{name:'广州'}, {name:'台湾',value:81}]]},
    geoCoord:{'河北': [114.5366,38.04320],
'辽宁': [123.4356,41.84147],
'香港': [114.1815,22.28293],
'山东': [117.0274,36.67486],
'云南': [102.7164,25.05156],
'江西': [115.9154,28.68169],
'陕西': [108.9604,34.27581],
'浙江': [120.1595,30.27155],
'台湾': [118.1393,24.50203],
'广州': [113.2708,23.13531],
'上海': [121.4802,31.23631]
    }

  ,markPoint : {
        symbol:'emptyCircle',
      symbolSize :13,
      effect : {
        show: true,
        type: 'scale',
        shadowBlur : 0
      },
      itemStyle:{
      normal:{
        label:{show:false},
        color:'white'
      },
      emphasis: {
        label:{show:false}
      }
      },
      data : [{name:'上海',value:63,symbol:'emptyCircle'},
{name:'河北',value:56,symbol:'emptyCircle'},
{name:'辽宁',value:52,symbol:'emptyCircle'},
{name:'香港',value:56,symbol:'emptyCircle'},
{name:'山东',value:52,symbol:'emptyCircle'},
{name:'云南',value: 9,symbol:'emptyCircle'},
{name:'江西',value:29,symbol:'emptyCircle'},
{name:'陕西',value: 6,symbol:'emptyCircle'},
{name:'浙江',value:71,symbol:'emptyCircle'},
{name:'台湾',value:10,symbol:'emptyCircle'}
      ]},
      geoCoord:{'河北': [114.5366,38.04320],
'辽宁': [123.4356,41.84147],
'香港': [114.1815,22.28293],
'山东': [117.0274,36.67486],
'云南': [102.7164,25.05156],
'江西': [115.9154,28.68169],
'陕西': [108.9604,34.27581],
'浙江': [120.1595,30.27155],
'台湾': [118.1393,24.50203],
'广州': [113.2708,23.13531],
'上海': [121.4802,31.23631]
                  }

  }]
}
;
  myChart.setOption(optionID_20211223002722_1789);
  </script>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="other-advanced-plots.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotly.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TuozhenLiu/Advanced-Visualiztion/edit/main/04-Maps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/TuozhenLiu/Advanced-Visualiztion/blob/main/04-Maps.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
